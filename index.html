<!doctypehtml><html lang=en><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Battleship Online</title><link href=https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css rel=stylesheet><script src=https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js></script><script src=https://www.gstatic.com/firebasejs/9.6.11/firebase-database-compat.js></script><style>body{background:#0b1622;color:#fff;font-family:sans-serif;text-align:center}#grids{display:flex;justify-content:center;gap:2rem;margin-top:2rem}.grid{display:grid;grid-template-columns:repeat(10,30px);grid-template-rows:repeat(10,30px);gap:2px}.cell{width:30px;height:30px;background-color:#1e293b;border:1px solid #334155;cursor:pointer}.cell.ship{background-color:#3b82f6}.cell.hit{background-color:#ef4444}.cell.miss{background-color:#94a3b8}.ship-piece{background-color:#2563eb;border-radius:4px;cursor:grab}#overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.9);color:#fff;display:flex;align-items:center;justify-content:center;font-size:4rem;opacity:0;transition:opacity 1s}</style><h1 class="text-3xl font-bold mt-4">âš“ Battleship Online</h1><div id=screen></div><div id=overlay></div><script>const firebaseConfig={apiKey:"AIzaSyBhfQ1Wf5JEy6sOU4ExXboRI4Ir4y_aKZw",authDomain:"easy-chatroom.firebaseapp.com",databaseURL:"https://easy-chatroom-default-rtdb.firebaseio.com",projectId:"easy-chatroom",storageBucket:"easy-chatroom.firebasestorage.app",messagingSenderId:"985049198428",appId:"1:985049198428:web:0cad8f285943b9f10c9b99",measurementId:"G-Q0YZGZLEMM"};firebase.initializeApp(firebaseConfig);const db=firebase.database(),screen=document.getElementById("screen"),overlay=document.getElementById("overlay");let username="",playerId="",gameId="",opponentId="",myTurn=!1,myShips=[],hits=0;const shipSizes=[5,4,3,3,2];function showUsernamePrompt(){screen.innerHTML='\n        <div class="mt-10">\n          <h2 class="text-xl mb-2">Enter Username</h2>\n          <input id="usernameInput" maxlength="14" class="text-black px-2 py-1" placeholder="Your name"/>\n          <button id="startBtn" class="bg-blue-600 hover:bg-blue-800 px-4 py-1 ml-2">Play</button>\n        </div>\n      ',document.getElementById("startBtn").onclick=()=>{const e=document.getElementById("usernameInput").value.trim();e&&e.length<=14?(username=e,findMatch()):alert("Invalid username!")}}async function findMatch(){screen.innerHTML="<h2 class='text-2xl mt-10 animate-pulse'>Searching for opponent...</h2>";const e=db.ref("matchmaking"),t=(await e.once("value")).val();if(t){const n=Object.keys(t)[0];playerId=Date.now().toString(),startGame(n,playerId),e.remove()}else{const t=Date.now().toString();playerId=t,await e.set({[t]:username}),e.on("value",(async t=>{const n=t.val();if(n&&Object.keys(n).length>1){const t=Object.keys(n).find((e=>e!==playerId));startGame(playerId,t),e.remove()}}))}}async function startGame(e,t){gameId=`game_${e}_${t}`;const n=db.ref(`games/${gameId}`);await n.set({players:{[e]:{name:username,grid:{},ready:!1,hits:0},[t]:{name:"Opponent",grid:{},ready:!1,hits:0}},turn:e}),opponentId=e===playerId?t:e,placeShipsPhase()}function createGrid(e,t=!1){const n=document.createElement("div");n.classList.add("grid");for(let e=0;e<100;e++){const a=document.createElement("div");a.classList.add("cell"),a.dataset.index=e,t&&(a.onclick=()=>tryHit(e)),n.appendChild(a)}return n}function placeShipsPhase(){screen.innerHTML='\n        <h2 class="text-2xl">Place your ships (20s)</h2>\n        <div id="countdown" class="text-xl mt-2">20</div>\n        <div id="grids"></div>\n        <button id="readyBtn" class="mt-4 bg-green-600 px-4 py-1">Ready</button>\n      ';const e=document.getElementById("grids"),t=createGrid("myGrid");e.appendChild(t);let n=20;const a=setInterval((()=>{n--,document.getElementById("countdown").innerText=n,n<=0&&(clearInterval(a),autoPlaceShips(t),sendReady())}),1e3);document.getElementById("readyBtn").onclick=()=>{clearInterval(a),sendReady()}}function autoPlaceShips(e){const t=[];for(;t.length<17;){let e=Math.floor(100*Math.random());t.includes(e)||t.push(e)}t.forEach((t=>e.children[t].classList.add("ship"))),myShips=t}async function sendReady(){const e=db.ref(`games/${gameId}/players/${playerId}`);await e.update({ready:!0,grid:myShips}),checkBothReady()}function checkBothReady(){db.ref(`games/${gameId}`).on("value",(e=>{const t=e.val();t&&Object.values(t.players).every((e=>e.ready))&&startBattle(t)}))}function startBattle(e){screen.innerHTML='\n        <h2 class="text-2xl mb-2">Battle Started!</h2>\n        <div id="turnInfo"></div>\n        <div id="countdown" class="text-xl mt-1">15</div>\n        <div id="grids">\n          <div>\n            <h3>Your Grid</h3>\n            <div id="myGrid" class="grid"></div>\n          </div>\n          <div>\n            <h3>Enemy Grid</h3>\n            <div id="enemyGrid" class="grid"></div>\n          </div>\n        </div>\n      ';const t=document.getElementById("myGrid"),n=document.getElementById("enemyGrid");for(let e=0;e<100;e++){const a=document.createElement("div");a.classList.add("cell"),myShips.includes(e)&&a.classList.add("ship"),t.appendChild(a);const d=document.createElement("div");d.classList.add("cell"),d.dataset.index=e,d.onclick=()=>tryHit(e),n.appendChild(d)}gameLoop()}function gameLoop(){db.ref(`games/${gameId}`).on("value",(e=>{const t=e.val();if(!t)return;myTurn=t.turn===playerId,document.getElementById("turnInfo").innerText=myTurn?"Your Turn":"Opponent's Turn";const n=t.players[opponentId]?.hits||0,a=t.players[playerId]?.hits||0;n>=17&&endGame(!1),a>=17&&endGame(!0)})),startTurnCountdown()}function startTurnCountdown(){let e=15;const t=document.getElementById("countdown"),n=setInterval((()=>{myTurn?(e--,t.innerText=e,e<=0&&(clearInterval(n),switchTurn())):clearInterval(n)}),1e3)}async function tryHit(e){if(!myTurn)return;const t=document.querySelector(`#enemyGrid .cell[data-index="${e}"]`),n=db.ref(`games/${gameId}/players/${opponentId}/grid`),a=((await n.once("value")).val()||[]).includes(e);if(t.classList.add(a?"hit":"miss"),a){const e=db.ref(`games/${gameId}/players/${playerId}`),t=await e.once("value"),n=(t.val()?.hits||0)+1;await e.update({hits:n})}switchTurn()}async function switchTurn(){const e=db.ref(`games/${gameId}`),t=(await e.once("value")).val().turn===playerId?opponentId:playerId;await e.update({turn:t})}function endGame(e){overlay.innerText=e?"Victory!":"Lost!",overlay.style.opacity=1,setTimeout((()=>db.ref(`games/${gameId}`).remove()),3e3)}showUsernamePrompt()</script>