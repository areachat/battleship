<!doctypehtml><html lang=en><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Battleship Online</title><link href=https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css rel=stylesheet><script src=https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js></script><script src=https://www.gstatic.com/firebasejs/9.6.11/firebase-database-compat.js></script><style>body{background:#0b1622;color:#fff;font-family:sans-serif;text-align:center}#grids{display:flex;justify-content:center;gap:2rem;margin-top:2rem}.grid{display:grid;grid-template-columns:repeat(10,30px);grid-template-rows:repeat(10,30px);gap:2px}.cell{width:30px;height:30px;background-color:#1e293b;border:1px solid #334155;cursor:pointer}.cell.ship{background-color:#3b82f6}.cell.hit{background-color:#ef4444}.cell.miss{background-color:#94a3b8}.ship-piece{background-color:#2563eb;border-radius:4px;cursor:grab}input{display:inline-block;width:200px}#overlay{pointer-events:none}#overlay.active{pointer-events:all}</style><h1 class="text-3xl font-bold mt-4">âš“ Battleship Online</h1><div id=screen></div><div id=overlay></div><script>const firebaseConfig={apiKey:"AIzaSyBhfQ1Wf5JEy6sOU4ExXboRI4Ir4y_aKZw",authDomain:"easy-chatroom.firebaseapp.com",databaseURL:"https://easy-chatroom-default-rtdb.firebaseio.com",projectId:"easy-chatroom",storageBucket:"easy-chatroom.appspot.com",messagingSenderId:"985049198428",appId:"1:985049198428:web:0cad8f285943b9f10c9b99",measurementId:"G-Q0YZGZLEMM"};firebase.initializeApp(firebaseConfig);const db=firebase.database(),screen=document.getElementById("screen"),overlay=document.getElementById("overlay");let username="",opponentName="",playerId="",opponentId="",gameId="",myShips=[],myTurn=!1,turnTimer=null;const shipSizes=[5,4,3,3,2],totalCells=shipSizes.reduce(((e,t)=>e+t),0);function showUsernamePrompt(){screen.innerHTML='\n  <div class="mt-10 flex flex-col items-center">\n    <h2 class="text-xl mb-4">Enter Username</h2>\n    <input id="usernameInput" maxlength="14"\n      class="bg-gray-800 text-white rounded px-3 py-2 w-60 mb-4 outline-none focus:ring-2 focus:ring-blue-500"\n      placeholder="Your name"/>\n    <button id="startBtn"\n      class="bg-blue-600 hover:bg-blue-800 px-4 py-2 rounded">Play</button>\n  </div>',document.getElementById("startBtn").onclick=()=>{const e=document.getElementById("usernameInput").value.trim();if(!e||e.length>14)return alert("Invalid username!");username=e,findMatch()}}async function findMatch(){screen.innerHTML="<h2 class='text-2xl mt-10 animate-pulse'>Searching for opponent...</h2>";const e=db.ref("matchmaking"),t=e.push({name:username,ts:Date.now()});playerId=t.key,e.on("value",(async t=>{const n=t.val()||{},a=Object.keys(n);if(a.length>=2){const[t,s]=a,r=`game_${t}_${s}`,o=db.ref(`games/${r}`);await o.set({players:{[t]:{name:n[t].name,grid:{},ready:!1,hits:0,sunk:[]},[s]:{name:n[s].name,grid:{},ready:!1,hits:0,sunk:[]}},turn:t}),await e.remove(),playerId!==t&&playerId!==s||(opponentId=playerId===t?s:t,opponentName=n[opponentId]?.name||"Opponent",gameId=r,placeShipsPhase())}}))}function createGrid(){const e=document.createElement("div");e.classList.add("grid");for(let t=0;t<100;t++){const n=document.createElement("div");n.classList.add("cell"),n.dataset.index=t,e.appendChild(n)}return e}function placeShipsPhase(){screen.innerHTML='\n  <h2 class="text-2xl">Placing your fleet (20s)</h2>\n  <div id="countdown" class="text-xl mt-2">20</div>\n  <div id="grids" class="flex justify-center mt-4"></div>\n  <button id="readyBtn" class="mt-4 bg-green-600 px-4 py-1 rounded">Ready</button>';const e=createGrid();document.getElementById("grids").appendChild(e),autoPlaceShips(e);let t=20;const n=setInterval((()=>{document.getElementById("countdown").innerText=t,--t<=0&&(clearInterval(n),sendReady())}),1e3);document.getElementById("readyBtn").onclick=()=>{clearInterval(n),sendReady()}}function autoPlaceShips(e){myShips=[],shipSizes.forEach((t=>{let n=!1;for(;!n;){const a=Math.floor(100*Math.random()),s=Math.floor(a/10),r=Math.random()<.5?"h":"v",o="h"===r?1:10,i=a+(t-1)*o,d=Math.floor(i/10);if(i>=100)continue;if("h"===r&&d!==s)continue;if("v"===r&&i>=100)continue;let c=!1;for(let e=0;e<t;e++){const t=a+e*o;myShips.includes(t)&&(c=!0)}if(!c){for(let n=0;n<t;n++){const t=a+n*o;e.children[t].classList.add("ship"),myShips.push(t)}n=!0}}}))}async function sendReady(){const e=db.ref(`games/${gameId}/players/${playerId}`);await e.update({ready:!0,grid:myShips}),waitForBothReady()}function waitForBothReady(){const e=db.ref(`games/${gameId}`);e.on("value",(t=>{const n=t.val();n&&Object.values(n.players).every((e=>e.ready))&&(e.off(),startBattle(n))}))}function startBattle(e){opponentName=e.players[opponentId].name,screen.innerHTML=`\n  <h2 class="text-2xl mb-2">Battle Commencing!</h2>\n  <div id="turnInfo" class="font-bold text-xl mb-2"></div>\n  <div id="countdown" class="text-xl mb-1">15</div>\n  <div id="grids" class="flex justify-center gap-4">\n    <div><h3><b>${username}</b></h3><div id="myGrid" class="grid"></div></div>\n    <div><h3><b>${opponentName}</b></h3><div id="enemyGrid" class="grid"></div></div>\n  </div>`;const t=document.getElementById("myGrid"),n=document.getElementById("enemyGrid");for(let e=0;e<100;e++){const a=document.createElement("div");a.classList.add("cell"),myShips.includes(e)&&a.classList.add("ship"),t.appendChild(a);const s=document.createElement("div");s.classList.add("cell"),s.dataset.index=e,n.appendChild(s)}setupGameLoop()}function setupGameLoop(){const e=db.ref(`games/${gameId}`);e.on("value",(t=>{const n=t.val();if(!n)return;myTurn=n.turn===playerId,document.getElementById("turnInfo").innerText=myTurn?"Your Turn":"Opponent's Turn",myTurn?startTurnTimer():stopTurnTimer();const a=n.players[opponentId]?.hits||0,s=n.players[playerId]?.hits||0;a>=totalCells&&endGame(!1,e),s>=totalCells&&endGame(!0,e)})),document.getElementById("enemyGrid").onclick=async e=>{if(!myTurn)return;const t=e.target;if(!t.classList.contains("cell")||t.classList.contains("hit")||t.classList.contains("miss"))return;const n=+t.dataset.index,a=db.ref(`games/${gameId}/players/${opponentId}/grid`),s=((await a.get()).val()||[]).includes(n);if(t.classList.add(s?"hit":"miss"),s){const e=db.ref(`games/${gameId}/players/${playerId}`),t=await e.get(),s=(t.val()?.hits||0)+1;await e.update({hits:s}),checkSunkShips(a,n)}await switchTurn()}}async function checkSunkShips(e,t){const n=(await e.get()).val()||[],a=[];n.sort(((e,t)=>e-t)),n.forEach((e=>{let t=!1;for(const n of a)if(n.some((t=>1===Math.abs(t-e)||10===Math.abs(t-e)))){n.push(e),t=!0;break}t||a.push([e])})),a.forEach((e=>{e.every((e=>document.querySelector(`#enemyGrid .cell[data-index='${e}']`)?.classList.contains("hit")))&&explodeAroundShip(e)}))}function explodeAroundShip(e){const t=[-11,-10,-9,-1,1,9,10,11];e.forEach((e=>{const n=Math.floor(e/10),a=e%10;t.forEach((t=>{const s=e+t,r=Math.floor(s/10),o=s%10;if(s>=0&&s<100&&Math.abs(r-n)<=1&&Math.abs(o-a)<=1){const e=document.querySelector(`#enemyGrid .cell[data-index='${s}']`);e&&!e.classList.contains("hit")&&e.classList.add("miss")}}))}))}function startTurnTimer(){let e=15;clearInterval(turnTimer);const t=document.getElementById("countdown");turnTimer=setInterval((()=>{t.innerText=e,e--,e<0&&(clearInterval(turnTimer),switchTurn())}),1e3)}function stopTurnTimer(){clearInterval(turnTimer)}async function switchTurn(){stopTurnTimer();const e=db.ref(`games/${gameId}`),t=(await e.get()).val();if(!t)return;const n=t.turn===playerId?opponentId:playerId;await e.update({turn:n})}function endGame(e,t){stopTurnTimer(),t.off(),document.getElementById("enemyGrid").style.pointerEvents="none",overlay.innerText=e?"VICTORY!":"DEFEAT!",overlay.style.cssText="opacity:1;font-size:6rem;font-weight:900;",setTimeout((()=>db.ref(`games/${gameId}`).remove()),4e3)}showUsernamePrompt()</script>