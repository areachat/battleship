<!doctypehtml><html lang=en><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Battleship Online</title><link href=https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css rel=stylesheet><script src=https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js></script><script src=https://www.gstatic.com/firebasejs/9.6.11/firebase-database-compat.js></script><style>body{background:#0b1622;color:#fff;font-family:sans-serif;text-align:center}#grids{display:flex;justify-content:center;gap:2rem;margin-top:2rem}.grid{display:grid;grid-template-columns:repeat(10,30px);grid-template-rows:repeat(10,30px);gap:2px}.cell{width:30px;height:30px;background-color:#1e293b;border:1px solid #334155;cursor:pointer}.cell.ship{background-color:#3b82f6}.cell.hit{background-color:#ef4444}.cell.miss{background-color:#94a3b8}.ship-piece{background-color:#2563eb;border-radius:4px;cursor:grab}input{display:inline-block;width:200px}#overlay{pointer-events:none}#overlay.active{pointer-events:all}</style><h1 class="text-3xl font-bold mt-4">âš“ Battleship Online</h1><div id=screen></div><div id=overlay></div><script>const firebaseConfig={apiKey:"AIzaSyBhfQ1Wf5JEy6sOU4ExXboRI4Ir4y_aKZw",authDomain:"easy-chatroom.firebaseapp.com",databaseURL:"https://easy-chatroom-default-rtdb.firebaseio.com",projectId:"easy-chatroom",storageBucket:"easy-chatroom.appspot.com",messagingSenderId:"985049198428",appId:"1:985049198428:web:0cad8f285943b9f10c9b99",measurementId:"G-Q0YZGZLEMM"};firebase.initializeApp(firebaseConfig);const db=firebase.database(),screen=document.getElementById("screen"),overlay=document.getElementById("overlay");let username="",playerId="",gameId="",opponentId="",myTurn=!1,myShips=[];const shipSizes=[5,4,3,3,2];function showUsernamePrompt(){screen.innerHTML='\n  <div class="mt-10 flex flex-col items-center">\n    <h2 class="text-xl mb-4">Enter Username</h2>\n    <input id="usernameInput" maxlength="14"\n           class="bg-gray-800 text-white rounded px-3 py-2 w-60 mb-4 outline-none focus:ring-2 focus:ring-blue-500"\n           placeholder="Your name"/>\n    <button id="startBtn"\n            class="bg-blue-600 hover:bg-blue-800 px-4 py-2 rounded">\n      Play\n    </button>\n  </div>',document.getElementById("startBtn").onclick=()=>{const e=document.getElementById("usernameInput").value.trim();e&&e.length<=14?(username=e,findMatch()):alert("Invalid username!")}}async function findMatch(){screen.innerHTML="<h2 class='text-2xl mt-10 animate-pulse'>Searching for opponent...</h2>";const e=db.ref("matchmaking"),t=e.push();playerId=t.key,await t.set({name:username,joined:Date.now()}),e.on("value",(async t=>{const n=t.val();if(!n)return;const a=Object.keys(n);if(a.length>=2){const[t,s]=a,d=`game_${t}_${s}`,r=db.ref(`games/${d}`);await r.set({players:{[t]:{name:n[t].name,grid:{},ready:!1,hits:0},[s]:{name:n[s].name,grid:{},ready:!1,hits:0}},turn:t}),await e.remove(),playerId!==t&&playerId!==s||(gameId=d,opponentId=playerId===t?s:t,placeShipsPhase())}}))}function createGrid(e=!1){const t=document.createElement("div");t.classList.add("grid");for(let e=0;e<100;e++){const n=document.createElement("div");n.classList.add("cell"),n.dataset.index=e,t.appendChild(n)}return t}function placeShipsPhase(){screen.innerHTML='\n  <h2 class="text-2xl">Place your ships (20s)</h2>\n  <div id="countdown" class="text-xl mt-2">20</div>\n  <div id="shipyard" class="flex gap-2 justify-center mt-4"></div>\n  <div id="grids" class="flex justify-center mt-4"></div>\n  <button id="readyBtn" class="mt-4 bg-green-600 px-4 py-1 rounded">Ready</button>';const e=document.getElementById("grids"),t=createGrid();e.appendChild(t);const n=document.getElementById("shipyard");shipSizes.forEach(((e,t)=>{const a=document.createElement("div");a.classList.add("ship-piece"),a.draggable=!0,a.dataset.size=e,a.style.width=32*e+"px",a.style.height="30px",a.style.background="#3b82f6",a.style.border="1px solid white",n.appendChild(a)})),t.ondragover=e=>e.preventDefault(),t.ondrop=e=>{e.preventDefault();const n=+e.dataTransfer.getData("size"),a=e.target;if(!a.classList.contains("cell"))return;const s=+a.dataset.index;placeShipOnGrid(t,s,n)},document.querySelectorAll(".ship-piece").forEach((e=>{e.ondragstart=e=>e.dataTransfer.setData("size",e.target.dataset.size)}));let a=20;const s=setInterval((()=>{a--,document.getElementById("countdown").innerText=a,a<=0&&(clearInterval(s),autoPlaceShips(t),sendReady())}),1e3);document.getElementById("readyBtn").onclick=()=>{clearInterval(s),sendReady()}}function placeShipOnGrid(e,t,n){Math.floor(t/10);if(t%10+n-1>=10)return alert("Ship doesn't fit!");for(let a=0;a<n;a++){const n=t+a;e.children[n].classList.add("ship"),myShips.includes(n)||myShips.push(n)}}function autoPlaceShips(e){myShips=[],shipSizes.forEach((t=>{let n=!1;for(;!n;){const a=Math.floor(100*Math.random());Math.floor(a/10);if(a%10+t-1<10){let s=!1;for(let e=0;e<t;e++)myShips.includes(a+e)&&(s=!0);if(!s){for(let n=0;n<t;n++)e.children[a+n].classList.add("ship"),myShips.push(a+n);n=!0}}}}))}async function sendReady(){const e=db.ref(`games/${gameId}/players/${playerId}`);await e.update({ready:!0,grid:myShips}),checkBothReady()}function checkBothReady(){const e=db.ref(`games/${gameId}`);e.on("value",(t=>{const n=t.val();n&&Object.values(n.players).every((e=>e.ready))&&(startBattle(n),e.off())}))}function startBattle(e){screen.innerHTML='\n    <h2 class="text-2xl mb-2">Battle Started!</h2>\n    <div id="turnInfo"></div>\n    <div id="countdown" class="text-xl mt-1">15</div>\n    <div id="grids" class="flex justify-center gap-4">\n      <div><h3>Your Grid</h3><div id="myGrid" class="grid"></div></div>\n      <div><h3>Enemy Grid</h3><div id="enemyGrid" class="grid"></div></div>\n    </div>';const t=document.getElementById("myGrid"),n=document.getElementById("enemyGrid");for(let e=0;e<100;e++){const a=document.createElement("div");a.classList.add("cell"),myShips.includes(e)&&a.classList.add("ship"),t.appendChild(a);const s=document.createElement("div");s.classList.add("cell"),s.dataset.index=e,s.onclick=()=>tryHit(e),n.appendChild(s)}gameLoop()}function gameLoop(){db.ref(`games/${gameId}`).on("value",(e=>{const t=e.val();if(!t)return;myTurn=t.turn===playerId,document.getElementById("turnInfo").innerText=myTurn?"Your Turn":"Opponent's Turn";const n=t.players[opponentId]?.hits||0,a=t.players[playerId]?.hits||0;n>=17&&endGame(!1),a>=17&&endGame(!0)})),startTurnCountdown()}function startTurnCountdown(){let e=15;const t=document.getElementById("countdown"),n=setInterval((()=>{myTurn?(e--,t.innerText=e,e<=0&&(clearInterval(n),switchTurn())):clearInterval(n)}),1e3)}async function tryHit(e){if(!myTurn)return;const t=document.querySelector(`#enemyGrid .cell[data-index="${e}"]`),n=db.ref(`games/${gameId}/players/${opponentId}/grid`),a=((await n.get()).val()||[]).includes(e);if(t.classList.add(a?"hit":"miss"),a){const e=db.ref(`games/${gameId}/players/${playerId}`),t=await e.get(),n=(t.val()?.hits||0)+1;await e.update({hits:n})}switchTurn()}async function switchTurn(){const e=db.ref(`games/${gameId}`),t=(await e.get()).val().turn===playerId?opponentId:playerId;await e.update({turn:t})}function endGame(e){overlay.innerText=e?"Victory!":"Lost!",overlay.classList.add("active"),overlay.style.opacity=1,setTimeout((()=>db.ref(`games/${gameId}`).remove()),3e3)}showUsernamePrompt()</script>